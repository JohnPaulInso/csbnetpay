
            <!-- Table 1: Dropdown in First Column -->
            <div class="table-responsive" style="font-size:10px;">
                <table class="table table-dark table-sm">
                    <thead>
                        <tr style="font-size:8px;">
                            <th class="dropdown-col">SLRY GRD</th>
                            <th>BASIC</th>
                            <th>PMTN NETPAY</th>
                        </tr>
                    </thead>
                    <tbody id="table1Body">
                        <!-- First Row -->
                        <tr>
                            <td style="font-size:7px;">
                                <select id="salaryGradeDropdown1" class="form-select bg-dark text-white" onchange="updateSalaryRow(1)">
                                    <!-- Dropdown options will be populated dynamically -->
                                </select>
                            </td>
                            <td id="basicPayTable1"></td>
                            <td id="prmtnNetpayTable1"></td>
                        </tr>
                        <!-- Second Row -->
                        <tr>
                            <td style="font-size:7px;">
                                <select id="salaryGradeDropdown2" class="form-select bg-dark text-white" onchange="updateSalaryRow(2)">
                                    <!-- Dropdown options will be populated dynamically -->
                                </select>
                            </td>
                            <td id="basicPayTable2"></td>
                            <td id="prmtnNetpayTable2"></td>
                        </tr>
                        <tr>
                            <td>DIFF</td>
                            <td id="basicPayTable3" style="    width: 20%;"></td>
                            <td>
                                <input id="promotion" type="text" class="bg-dark text-light border-0" style="font-size:11px; font-weight: bold;" value="">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>





<script>
    // Load and parse CSV when the page is loaded
    window.onload = function () {
        loadprmtnCSV();
    };

    // Function to load and parse CSV file
    function loadprmtnCSV() {
        fetch("promotion_bracket.csv")
            .then(response => response.text())
            .then(data => {
                const parsedData = parseCSV(data);
                populateSalaryDropdown(parsedData);
            })
            .catch(error => console.error("Error loading CSV:", error));
    }

    // Function to parse CSV data into an array of objects
    function parseCSV(data) {
        const rows = data.split('\n').map(row => row.split(','));
        const jsonData = rows.slice(1).map(row => {
            return {
                // Using direct indexing for each required column
                salaryGrade: row[0] ? row[0].trim() : '',
                basicPay: row[1] ? row[1].trim() : '',
                remarks: row[11] ? row[11].trim() : '' // OLD TAX at index 7
            };
        });
        return jsonData;
    }

    // Function to populate both dropdowns with unique salary grade steps
    function populateSalaryDropdown(data) {
        const dropdown1 = document.getElementById("salaryGradeDropdown1");
        const dropdown2 = document.getElementById("salaryGradeDropdown2");
        const uniqueSalaryGradeStep = new Set();

        data.forEach(row => {
            const salaryGradeStep = row.salaryGrade; // Get the salary grade directly

            // Populate dropdown only if the option is unique
            if (!uniqueSalaryGradeStep.has(salaryGradeStep)) {
                uniqueSalaryGradeStep.add(salaryGradeStep);

                const option1 = new Option(salaryGradeStep, salaryGradeStep);
                dropdown1.add(option1);

                const option2 = new Option(salaryGradeStep, salaryGradeStep);
                dropdown2.add(option2);
            }
        });
    }

    // Global variables to store selected values for comparison
    let firstRowBasicPay = 0;
    let secondRowBasicPay = 0;
    let firstRowprmtnNetpay = 0;
    let secondRowprmtnNetpay = 0;

    // Helper function to clean and parse the numeric values from the table
    function parseValue(value) {
        return parseFloat(value.replace(/,/g, '') || 0);  // Remove commas and parse as float, default to 0
    }

    // Update only the specific row's data based on dropdown selection
    function updateSalaryRow(rowNumber) {
        const selectedSalaryGrade = document.getElementById(`salaryGradeDropdown${rowNumber}`).value;

        fetch("promotion_bracket.csv")
            .then(response => response.text())
            .then(data => {
                const parsedData = parseCSV(data);

                // Log the parsed data to check its structure
                console.log("Parsed CSV Data:", parsedData);

                // Use the find method to locate the row based on selected salary grade
                const filteredData = parsedData.find(row => {
                    return row.salaryGrade === selectedSalaryGrade;
                });

                // Log the filtered data to see what was found
                console.log("Filtered Data:", filteredData);

                if (filteredData) {
                    const basicPay = parseValue(filteredData.basicPay);
                    const prmtnNetpay = parseValue(filteredData.remarks); // Use remarks from parsedData

                    // Update the specific row
                    document.getElementById(`basicPayTable${rowNumber}`).textContent = basicPay.toLocaleString();
                    document.getElementById(`prmtnNetpayTable${rowNumber}`).textContent = prmtnNetpay.toLocaleString();

                    // Store values in global variables based on the row number
                    if (rowNumber === 1) {
                        firstRowBasicPay = basicPay;
                        firstRowprmtnNetpay = prmtnNetpay;
                    } else if (rowNumber === 2) {
                        secondRowBasicPay = basicPay;
                        secondRowprmtnNetpay = prmtnNetpay;
                    }

                    // Calculate and display the difference if both rows have values
                    calculateSalaryDifference();
                } else {
                    console.warn("No data found for the selected salary grade:", selectedSalaryGrade);
                }
            })
            .catch(error => console.error("Error updating salary row:", error));
    }

    // Function to calculate the differences
    function calculateSalaryDifference() {
        if (firstRowBasicPay !== 0 && secondRowBasicPay !== 0) {
            const basicPayDifference = secondRowBasicPay - firstRowBasicPay;
            document.getElementById("basicPayTable3").textContent = basicPayDifference.toLocaleString();
        }

        if (firstRowprmtnNetpay !== 0 && secondRowprmtnNetpay !== 0) {
            const prmtnNetpayDifference = secondRowprmtnNetpay - firstRowprmtnNetpay;
            document.getElementById("promotion").value = prmtnNetpayDifference.toLocaleString();
        }
    }
</script>


